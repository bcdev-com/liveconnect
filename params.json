{"name":"liveconnect","body":"# Motivation\r\nThe current beta of the LiveConnect V5 SDK provides a very thin managed layer over the over the REST API, and the provided library is only usable in Metro-style applications.   While this will be important eventually, a retail release of Windows 8 is still a long way off.   This project attempts to provide a higher level of abstraction in a managed API for the Windows Live services exposed via Live Connect.\r\n\r\n# Limitations\r\nThe first big restriction is that this library is currently exclusively synchronous.   Once the C# 5 compiler with async/await support comes closer to release this will change.   For now, the viable use-cases involve command-line tools or dedicated background threads.\r\n\r\nThis is a pre-release library written on top of a pre-release API.  It works for me, but it might eat all your sensitive files tomorrow.\r\n\r\n# Architecture\r\nThere are two layers to the API which may be used independently:\r\n* The LiveConnect class handles authentication/consent and provides methods to put and get strings, byte arrays and automatically JSON-serialized classes.   It also provides static helper methods for configuration management and Live Connect application creation.\r\n* Service-specific classes, of which SkyDrive is the only one supported in the initial release.  SkyDrive provides an API that mimics the standard File, DirectoryInfo and FileInfo classes from System.IO.\r\n\r\nThe code may be compiled three ways – WPF, WinForms, or no UI libraries at all.   The browser dialog used for authentication adapts to either UI library.   When compiled without any UI libraries, an OAuth refresh token may be provided or the access token may be provided by an external tool.\r\n\r\nTo facilitate the UI-free model, the LiveConnect class includes an entry point and can be compiled as a standalone executable bound to either WPF or WinForms.   This resulting tool will create config files with the necessary refresh token or produce short-term access tokens.\r\n\r\n# Configuration\r\nYou’ll notice there are no project files.   It will be easiest to explore from a PowerShell console, but the source is meant to be built into other projects.\r\nThe classes work with JSON formatted configuration strings.   Before you can try this code out you will need to create an application at http://manage.dev.live.com and copy your client_id and client_secret into a local config file.  See ExampleConfig.json for a starting point.\r\n\r\n# Example\r\n```C#\r\nusing System;\r\nclass App {\r\n    [STAThread]\r\n    static int Main(string[] args) {\r\n        if (args.Length != 1) {\r\n            Console.Error.WriteLine(\"usage: TestApp <json-config-file>\");\r\n            return 1;\r\n        }\r\n        try {\r\n            using (var sd = new SkyDrive(args[0])) {\r\n                DisplayFolder(sd.Root);\r\n                var testFolder = sd.Root.CreateSubfolder(\"LiveConnectTesting\");\r\n                testFolder.CreateFile(\"test.txt\", \"Hello, World!\");\r\n                sd.Root.Refresh();\r\n                var fileContents = sd.GetFile(\"/LiveConnectTesting/test.txt\").ReadAllText();\r\n                Console.WriteLine(fileContents);\r\n            }\r\n            return 0;\r\n        } catch (Exception e) {\r\n            Console.Error.WriteLine(e.Message);\r\n            return 1;\r\n        }\r\n    }\r\n    static void DisplayFolder(SkyDriveFolder folder) {\r\n        Console.WriteLine(\"{0}/ - {1} children\", folder.FullName, folder.Count);\r\n        foreach(var subfolder in folder.GetFolders()) \r\n            DisplayFolder(subfolder);\r\n        foreach(var file in folder.GetFiles()) \r\n            Console.WriteLine(\"{0} - {1} bytes\", file.FullName, file.Length);\r\n    }\r\n}\r\n```\r\n\r\n# Future\r\nThe original motivation for this library was to provide a PowerShell provider to enable rich, easy scripting and command line access to SkyDrive.   Look for this in a future release.  Wrappers for services other than SkyDrive are likely as well.   In particular, the Calendar is probably next.\r\n\r\n# Contact\r\nI can be reached via email at blake@bcdev.com or feel free to open an issue in this project.","tagline":"A higher-level, managed code, desktop-application oriented API on top of the LiveConnect REST API.","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}